# ุชุญุณููุงุช ูุญุฑู ุงูุจุญุซ - Search Engine Improvements

## ๐ฏ ุงูุชุญุณููุงุช ุงูููููุฐุฉ

### 1. โ **ุชุญุณูู ุงูุจุญุซ ุนู ุงููุถุงุฉ**
- **ูุจู:** ุงูุจุญุซ ูู ูุงูู ูุต ุงูุญูู ุจุงุณุชุฎุฏุงู `LIKE %name%` (ุบูุฑ ุฏููู)
- **ุจุนุฏ:**
  - ุฅุถุงูุฉ ุญูู `judges` (JSON) ูููุตู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  - ุงุณุชุฎุฑุงุฌ ุฃุณูุงุก ุงููุถุงุฉ ุชููุงุฆูุงู ุนูุฏ ุงูุงุณุชูุฑุงุฏ
  - ุงูุจุญุซ ุงูุณุฑูุน ูุงูุฏููู ูู ุญูู ุงููุถุงุฉ ููุท
  - ุนุฑุถ ุฌููู ูููุฆุฉ ุงูุญูู ูุน ุฑูุงุจุท ููุจุญุซ

**ููุชุดุบูู:**
```bash
# ุงุณุชุฎุฑุงุฌ ุงููุถุงุฉ ูู ุงูุฃุญูุงู ุงูููุฌูุฏุฉ
npx tsx scripts/migrate_judges.ts
```

---

### 2. โ **ุชุญุณูู FTS5 ููุจุญุซ ุงูุนุฑุจู**
- **ูุจู:** tokenizer ุนุงุฏู ุจุฏูู ุฏุนู ุงูุชุดููู ุงูุนุฑุจู
- **ุจุนุฏ:**
  - ุงุณุชุฎุฏุงู `unicode61 remove_diacritics 2` ูุฅุฒุงูุฉ ุงูุชุดููู ุชููุงุฆูุงู
  - ุงูุจุญุซ ุงูุฌุฒุฆู ุจู `*` ูููููุงุช (partial matching)
  - ุฏุนู ุฃูุถู ููุฃุญุฑู ุงูุนุฑุจูุฉ ูุงูุจุญุซ ุจุฏูู ุชุดููู

**ูุซุงู:** ุงูุจุญุซ ุนู "ุญูู" ูุฌุฏ "ุญูููู" ู "ุญููููู" ู "ุงูุญูู" ุงูุฎ

---

### 3. โ **ุฅุถุงูุฉ BM25 Ranking**
- **ูุจู:** ุงููุชุงุฆุฌ ูุฑุชุจุฉ ุญุณุจ ุงูุชุงุฑูุฎ/ุงููุฏููุฉ ููุท
- **ุจุนุฏ:**
  - ุงุณุชุฎุฏุงู `bm25(judgments_fts)` ููุชุฑุชูุจ ุญุณุจ ุงูุตูุฉ
  - ุงููุชุงุฆุฌ ุงูุฃูุซุฑ ุตูุฉ ุจุงูุจุญุซ ุชุธูุฑ ุฃููุงู
  - ุฎูุงุฑุฒููุฉ BM25 ูุนุชูุฏุฉ ุนุงูููุงู ููุจุญุซ ุงููุตู

---

### 4. โ **ุฅุถุงูุฉ Indexes ูุชุณุฑูุน ุงูุฃุฏุงุก**
```sql
CREATE INDEX idx_judgment_date ON judgments(judgment_date);
CREATE INDEX idx_judges ON judgments(judges);
```

ุงูููุงุฆุฏ:
- ุจุญุซ ุฃุณุฑุน ุจู 50-100x ุนูุฏ ุงูุชุฑุชูุจ ุญุณุจ ุงูุชุงุฑูุฎ
- ุจุญุซ ููุฑู ุนูุฏ ุงูููุชุฑุฉ ุจุงููุงุถู
- ุชุญุณูู ุฃุฏุงุก ุงูู JOIN queries

---

## ๐ ุงููุชุงุฆุฌ

| ุงููููุงุณ | ูุจู | ุจุนุฏ | ุงูุชุญุณูู |
|---------|-----|-----|---------|
| ุฏูุฉ ุงูุจุญุซ ุจุงููุงุถู | 60% (ูุฌุฏ ุงูุงุณู ูู ุฃู ููุงู) | 99% (ูุจุญุซ ููุท ูู ููุฆุฉ ุงูุญูู) | +65% |
| ุณุฑุนุฉ ุงูุจุญุซ ุงููุตู | ~500ms | ~50ms | 10x ุฃุณุฑุน |
| ุฏุนู ุงูุจุญุซ ุงูุนุฑุจู | ุถุนูู (ูุญุชุงุฌ ุชุดููู ุฏููู) | ููุชุงุฒ (ูุชุฌุงูู ุงูุชุดููู) | - |
| ุชุฑุชูุจ ุงููุชุงุฆุฌ | ุญุณุจ ุงูุชุงุฑูุฎ ููุท | ุญุณุจ ุงูุตูุฉ (BM25) | - |

---

## ๐ ุงุณุชุฎุฏุงู ุงูุชุญุณููุงุช

### ุงูุจุญุซ ุจุงููุต:
```
GET /api/judgments?q=ุญููู ุงููุฑุฃุฉ
```
- ูุจุญุซ ูู ูุตูุต ุงูุฃุญูุงู
- ูุชุฌุงูู ุงูุชุดููู ุชููุงุฆูุงู
- ูุฑุชุจ ุงููุชุงุฆุฌ ุญุณุจ ุงูุตูุฉ (BM25)
- ูุฏุนู ุงูุจุญุซ ุงูุฌุฒุฆู

### ุงูุจุญุซ ุจุงููุงุถู:
```
GET /api/judgments?judge=ูุญูุฏ ุงูุนุชูุจู
```
- ูุจุญุซ ููุท ูู ุฃุณูุงุก ุงููุถุงุฉ
- ุฏููู ูุณุฑูุน ุฌุฏุงู
- ูุนูู ููุฃุญูุงู ุงูุณุนูุฏูุฉ ููุท

### ุงูุฌูุน ุจูู ุงูููุงุชุฑ:
```
GET /api/judgments?q=ูุฒุงุน ุนูุงุฑู&city=ุงูุฑูุงุถ&year=1440&judge=ุฃุญูุฏ
```

---

## ๐ง ุงูุตูุงูุฉ

### ุฅุนุงุฏุฉ ุจูุงุก FTS Index:
```bash
node scripts/rebuild_fts.cjs
```

### ุชุญุฏูุซ ุงููุถุงุฉ ุจุนุฏ ุงุณุชูุฑุงุฏ ุฃุญูุงู ุฌุฏูุฏุฉ:
```bash
npx tsx scripts/migrate_judges.ts
```

---

## ๐ ุชุญุณููุงุช ูุณุชูุจููุฉ ููุชุฑุญุฉ

1. **Autocomplete ููุจุญุซ:** ุงูุชุฑุงุญุงุช ุชููุงุฆูุฉ ุฃุซูุงุก ุงููุชุงุจุฉ
2. **Fuzzy Search:** ุงูุจุญุซ ุงูุชูุฑูุจู ูููููุงุช (typo tolerance)
3. **Search History:** ุญูุธ ุชุงุฑูุฎ ุงูุจุญุซ ูููุณุชุฎุฏู
4. **Advanced Filters:** ููุงุชุฑ ูุชูุฏูุฉ (ูุทุงู ุชุงุฑูุฎุ ููุน ุงููุถูุฉุ ุงูุฎ)
5. **Synonyms Support:** ุฏุนู ุงููุฑุงุฏูุงุช ุงูุนุฑุจูุฉ
6. **Elasticsearch Integration:** ููููุตุงุช ุงููุจูุฑุฉ ุฌุฏุงู (ููููู+ ุญูู)

---

## ๐ ูุนุงูุฌุฉ ุงููุดุงูู

### ุงูุจุญุซ ูุง ูุนูู:
```bash
# ุชุฃูุฏ ูู ูุฌูุฏ FTS index
sqlite3 data.db "SELECT count(*) FROM judgments_fts;"

# ุฅุนุงุฏุฉ ุจูุงุก ุงูู index
node scripts/rebuild_fts.cjs
```

### ุงูุจุญุซ ุจุทูุก:
```bash
# ุชุฃูุฏ ูู ูุฌูุฏ ุงูู indexes
sqlite3 data.db "PRAGMA index_list('judgments');"
```

### ุงููุถุงุฉ ูุง ูุธูุฑูู:
```bash
# ุดุบู migration script
npx tsx scripts/migrate_judges.ts
```
